<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
		<script src="/fallout-fission/assets/jquery.teletype.js"></script>
		<script>
		$( function() {
			$( '.type-text' ).each( function() {
				var items = $( this ).attr( 'title' ) + ';' + $( this ).text();
				$( this ).empty().attr( 'title', '' ).teletype( {
					text: $.map( items.split( ';' ), $.trim ),
					typeDelay: 10,
					backDelay: 20,
					humanise: true,
					cursor: '▋', 
					delay: 3000,
					preserve: false,
					prefix: '',
					loop: 0
				} );
			} );
		} );
		</script>

<script>
$(function () {

    const intro = [
        "FALLOUT: F.I.S.S.I.O.N. v0.1.0",
        "Flexible Isometric Simulation System — Initializing...",
        ""
    ];

    const modules = [
        "CORE_RUNTIME",
        "ISOMETRIC_RENDER_PIPELINE",
        "ASSET_STREAMING_ENGINE",
        "SCRIPT_EXECUTION_LAYER",
        "WORLD_SIMULATION_KERNEL",
        "UI_FRAMEWORK",
        "SAVE_STATE_MANAGER",
        "EVENT_DISPATCH_SYSTEM"
    ];

    const moduleStream =
        modules.join(" ........ ") +
        " ........ COMPLETE";

    const output = intro.concat([moduleStream]);

    $('#terminal').teletype({
        text: output,
        loop: false,
        pause: 800,

        delay: function (char, index) {

            // Fast progress dots
            if (char === ".") {
                return 6;
            }

            // Slight hesitation at spaces (drive reposition)
            if (char === " ") {
                return 40;
            }

            // Slight stall at module boundaries
            if (char === "_") {
                return 90;
            }

            // Heavy feel for capital letters
            if (/[A-Z]/.test(char)) {
                return 60 + Math.random() * 40;
            }

            // Occasional random micro-stall (rare disk seek)
            if (Math.random() < 0.02) {
                return 180;
            }

            // Default typing speed
            return 25 + Math.random() * 30;
        }
    });

});
</script>

{% if site.ios_app_id %}

<script type="text/javascript" src="/fallout-fission/assets/zoom.js"></script>
<script>

$(function() {

    var apiURL = "https://itunes.apple.com/lookup?id={{ site.ios_app_id }}&country={{ site.ios_app_country }}&callback=?";

    $.getJSON(apiURL, function(json) {

        if (json.results && json.results.length) {

            console.info("Image strings loaded from Apple API.");
            var appInfo = json.results[0];

            // Set favicon
            $('link[rel="shortcut icon"]').attr("href", appInfo.artworkUrl512);

            // Set page title using the iOS app ID if it is not set manually in _config.yml
            var $pageTitle = $(".pageTitle");
            if ($.trim($($pageTitle).text()).length == 0) {
                $($pageTitle).html(appInfo.trackName);
            }

            // Set large app icon using the iOS app ID if it is not set manually in _config.yml
            var $appIconLarge = $(".appIconLarge");
            if (!$appIconLarge.attr('src')) {
                $($appIconLarge).attr("src", appInfo.artworkUrl512);
            }

            // Set header app icon using the iOS app ID if it is not set manually in _config.yml
            var $appIconHeader = $(".headerIcon");
            if (!$appIconHeader.attr('src')) {
                $($appIconHeader).attr("src", appInfo.artworkUrl512);
            }

            // Set app name using the iOS app ID if it is not set manually in _config.yml
            var $appName = $(".appName");
            if ($.trim($($appName).text()).length == 0) {
                $($appName).html(appInfo.trackName);
            }

            // Set the name displayed in the header if it is not set manually in _config.yml
            var $headerName = $(".headerName");
            if ($.trim($($headerName).text()).length == 0) {
                $($headerName).html(appInfo.trackName);
            }

            // Set price using the iOS app ID if it is not set manually in _config.yml
            var $appPrice = $(".appPrice");
            if ($.trim($($appPrice).text()).length == 0) {
                $($appPrice).html(appInfo.formattedPrice);
            }

            // Set App Store link using the iOS app ID if it is not set manually in _config.yml
            var $appStoreLink = $(".appStoreLink");
            if ($.trim($appStoreLink.attr('href')).length == 0) {
                $($appStoreLink).attr("href", appInfo.trackViewUrl);
            }

            console.info(appInfo);

        }
    });  
});

</script>

{% endif %}
